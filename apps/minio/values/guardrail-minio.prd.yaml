---
mode: standalone

image:
  tag: RELEASE.2025-04-22T22-12-26Z

existingSecret: minio-secrets-prd

persistence:
  size: 20Gi

resources:
  requests:
    memory: 128Mi
    cpu: 50m
  limits:
    memory: 256Mi
    cpu: 200m
 
policies:
  - name: guardrail-readwrite
    statements:
      - resources:
          - "arn:aws:s3:::guardrail"
          - "arn:aws:s3:::guardrail/*"
        actions:
          - "s3:*"
        effect: Allow

users:
  - accessKey: admin
    existingSecret: minio-secrets-prd
    existingSecretKey: adminSecretKey
    policy: consoleAdmin
  - accessKey: guardrail
    existingSecret: minio-secrets-prd
    existingSecretKey: guardrailSecretKey
    policy: guardrail-readwrite

buckets:
  - name: guardrail
    policy: none
    purge: false
    versioning: false

consoleIngress:
  enabled: true
  ingressClassName: nginx
  hosts:
    - host: minio.workrave.org
      paths:
        - path: /
          pathType: Prefix
  tls:
    - hosts:
        - minio.workrave.org
      secretName: minio-tls
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"

